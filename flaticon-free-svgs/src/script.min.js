!function(){function t(){document.querySelectorAll("div.download").forEach((t=>{const n=t.parentElement;if(!n.querySelector(".ayy")){const t=e("Pirate that shit (needs login)","ayy bj-button fullwidth",i);n.appendChild(t)}}))}function e(t,e,n){const o=document.createElement("button");return o.textContent=t,o.className=e,o.onclick=n,o}function n(t,e="download.svg"){const n=document.createElement("a");n.href=t,n.download=e,n.click()}function o(){return document.querySelector("#keyword")?.getAttribute("value")||"download"}function c(){const t=document.querySelector(".icon-holder");if(!t)return;const e=t.innerHTML.replace(/\b(width|height)="[^"]*"/g,"");n(`data:image/svg+xml,${encodeURIComponent(e)}`,o()+".svg")}function i(){const t=document.querySelector("[data-id][data-elementid], section[data-id][data-icon_type], section[data-elementid][data-icon_type]");if(!t)return;const e=t.getAttribute("data-id")||t.getAttribute("data-elementid");e&&fetch(`/editor/icon/svg/${e}`).then((t=>t.json())).then((t=>{n(t.url,o()+".svg")})).catch(console.error)}function a(t){if(!t.classList.contains("show-menu"))return;const o=t.querySelector("ul");if(!o||o.querySelector(".ayy3"))return;const i=document.createElement("li"),a=e("Pirate","ayy3 bj-button mg-top-lv2",(()=>{t.closest("section.detail, .detail_editor, .icon-editor")?c():function(t){const e=t.closest(".icon--holder")||t.closest("section[data-id]");if(!e)return;let o=null,c="download";const i=e.querySelector("a.view.link-icon-detail");i?.dataset.id?(o=i.dataset.id,c=i.getAttribute("title")||c):(o=e.getAttribute("data-id"),c=e.getAttribute("data-keyword_id")||c),o&&fetch(`/editor/icon/svg/${o}`).then((t=>t.json())).then((t=>{n(t.url,c+".svg")})).catch(console.error)}(t)}));i.appendChild(a),o.appendChild(i)}new MutationObserver((e=>{t(),e.forEach((t=>{if(t.addedNodes.forEach((t=>{t instanceof HTMLElement&&t.matches(".popover-content.show-menu")&&a(t)})),"attributes"===t.type&&t.target instanceof HTMLElement){const e=t.target;e.classList.contains("popover-content")&&e.classList.contains("show-menu")&&a(e)}}))})).observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]}),t(),function(){if(document.querySelector(".ayy2"))return;const t=document.querySelector("div.edit-icons-user-actions");if(t){const n=e("Pirate that shit","ayy2 bj-button mg-left-lv1",c);t.insertAdjacentElement("afterend",n)}}()}();